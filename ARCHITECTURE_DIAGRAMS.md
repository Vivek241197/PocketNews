# ðŸŽ¯ PocketNews v2.0 - Architecture & Flow Diagrams

## ðŸ“± User Journey Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    POCKETNEWS USER JOURNEY                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   APP OPENS         â”‚
â”‚  (Fresh Install)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â–º Generate DeviceID (UUID-like)
           â”œâ”€â–º Store in localStorage
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: SELECT LANGUAGE                 â”‚
â”‚                                          â”‚
â”‚  Options:                                â”‚
â”‚  â—‹ English (English)                     â”‚
â”‚  â—‹ à¤¹à¤¿à¤‚à¤¦à¥€ (Hindi)                          â”‚
â”‚  â—‹ à®¤à®®à®¿à®´à¯ (Tamil)                         â”‚
â”‚  â—‹ à°¤à±†à°²à±à°—à± (Telugu)                       â”‚
â”‚  â—‹ à²•à²¨à³à²¨à²¡ (Kannada)                       â”‚
â”‚  â—‹ à´®à´²à´¯à´¾à´³à´‚ (Malayalam)                   â”‚
â”‚  â—‹ à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali)                       â”‚
â”‚  â—‹ à¨ªà©°à¨œà¨¾à¨¬à©€ (Punjabi)                      â”‚
â”‚  â—‹ à¤®à¤°à¤¾à¤ à¥€ (Marathi)                       â”‚
â”‚  â—‹ àª—à«àªœàª°àª¾àª¤à«€ (Gujarati)                    â”‚
â”‚  â—‹ Ø§Ø±Ø¯Ùˆ (Urdu)                           â”‚
â”‚  â—‹ à¬“à¬¡à¬¼à¬¿à¬† (Odia)                          â”‚
â”‚                                          â”‚
â”‚  POST /onboarding/step1                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: ENTER AGE                       â”‚
â”‚                                          â”‚
â”‚  Input field: [__________]               â”‚
â”‚  Validation: Age >= 13                   â”‚
â”‚                                          â”‚
â”‚  POST /onboarding/step2                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: SELECT CATEGORIES               â”‚
â”‚                                          â”‚
â”‚  â˜‘ Technology                            â”‚
â”‚  â˜‘ Entertainment                         â”‚
â”‚  â˜‘ Regional News                         â”‚
â”‚  â˜‘ Sports                                â”‚
â”‚  â˜ Business                              â”‚
â”‚  â˜ Health                                â”‚
â”‚  [At least 1 required]                   â”‚
â”‚                                          â”‚
â”‚  POST /onboarding/step3                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… ONBOARDING COMPLETE                  â”‚
â”‚                                          â”‚
â”‚  User Profile Stored:                    â”‚
â”‚  - deviceId: "device-xyz"                â”‚
â”‚  - age: 25                               â”‚
â”‚  - language: "hi"                        â”‚
â”‚  - categories: [1, 2, 3]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸŽ‰ BROWSE PERSONALIZED NEWS FEED        â”‚
â”‚                                          â”‚
â”‚  GET /news/category/{categoryId}         â”‚
â”‚  GET /news/featured                      â”‚
â”‚  GET /news                               â”‚
â”‚                                          â”‚
â”‚  [Article 1] â¤ï¸ 45  ðŸ’¬ 12  ðŸ”– Save      â”‚
â”‚  [Article 2] â¤ï¸ 23  ðŸ’¬ 8   ðŸ”– Save      â”‚
â”‚  [Article 3] â¤ï¸ 67  ðŸ’¬ 25  ðŸ”– Save      â”‚
â”‚                                          â”‚
â”‚  All actions use: ?deviceId=device-xyz   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Returning User:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   APP OPENS         â”‚
â”‚ (Returning User)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â–º Retrieve deviceId from localStorage
           â”œâ”€â–º GET /onboarding/profile/{deviceId}
           â”œâ”€â–º GET /onboarding/preferences/{deviceId}
           â”‚
           â–¼
       âœ… READY - Browse personalized feed immediately!
```

---

## ðŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT LAYER                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Mobile App / Web Browser                                    â”‚  â”‚
â”‚  â”‚  - Store deviceId in localStorage                           â”‚  â”‚
â”‚  â”‚  - Make HTTP requests with deviceId parameter              â”‚  â”‚
â”‚  â”‚  - Handle language preference dynamically                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP/JSON
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API LAYER (Spring Boot)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ CONTROLLERS (REST Endpoints)                                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ â€¢ OnboardingController  (7 endpoints) - NEW                    â”‚ â”‚
â”‚  â”‚ â€¢ NewsController        (7 endpoints)                          â”‚ â”‚
â”‚  â”‚ â€¢ CategoryController    (5 endpoints)                          â”‚ â”‚
â”‚  â”‚ â€¢ CommentController     (4 endpoints) - Updated               â”‚ â”‚
â”‚  â”‚ â€¢ LikeController        (2 endpoints) - Updated               â”‚ â”‚
â”‚  â”‚ â€¢ BookmarkController    (3 endpoints) - Updated               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ SERVICES (Business Logic)                                      â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ â€¢ OnboardingService     - NEW                                  â”‚ â”‚
â”‚  â”‚ â€¢ NewsService                                                  â”‚ â”‚
â”‚  â”‚ â€¢ CategoryService                                              â”‚ â”‚
â”‚  â”‚ â€¢ CommentService        - Updated (uses deviceId)              â”‚ â”‚
â”‚  â”‚ â€¢ LikeService           - Updated (uses deviceId)              â”‚ â”‚
â”‚  â”‚ â€¢ BookmarkService       - Updated (uses deviceId)              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ REPOSITORIES (Data Access)                                     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ â€¢ UserRepository        - findByDeviceId()                     â”‚ â”‚
â”‚  â”‚ â€¢ NewsRepository        - findByCategoryId(), etc.             â”‚ â”‚
â”‚  â”‚ â€¢ CategoryRepository                                           â”‚ â”‚
â”‚  â”‚ â€¢ CommentRepository     - findByNewsId()                       â”‚ â”‚
â”‚  â”‚ â€¢ LikeRepository        - Updated queries                      â”‚ â”‚
â”‚  â”‚ â€¢ BookmarkRepository    - Updated queries                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ENTITIES (JPA Models)                                          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ â€¢ User         (id, deviceId, age, language, dates)            â”‚ â”‚
â”‚  â”‚ â€¢ News         (id, title, content, categoryId, dates)         â”‚ â”‚
â”‚  â”‚ â€¢ Category     (id, name, slug, displayOrder, dates)           â”‚ â”‚
â”‚  â”‚ â€¢ Comment      (id, newsId, deviceId, content, dates)          â”‚ â”‚
â”‚  â”‚ â€¢ Like         (id, newsId, deviceId, createdAt)               â”‚ â”‚
â”‚  â”‚ â€¢ Bookmark     (id, deviceId, newsId, createdAt)               â”‚ â”‚
â”‚  â”‚ â€¢ UserPref     (id, userId, preferredCategories)               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ JDBC
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE LAYER                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PostgreSQL (Supabase)                                          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Tables:                                                        â”‚ â”‚
â”‚  â”‚ â€¢ users        (id, device_id UNIQUE, age, language)          â”‚ â”‚
â”‚  â”‚ â€¢ news         (id, title, content, category_id FK)           â”‚ â”‚
â”‚  â”‚ â€¢ categories   (id, name, slug UNIQUE, displayOrder)          â”‚ â”‚
â”‚  â”‚ â€¢ comments     (id, news_id FK, device_id, content)           â”‚ â”‚
â”‚  â”‚ â€¢ likes        (id, news_id FK, device_id, UNIQUE(news, dev)) â”‚ â”‚
â”‚  â”‚ â€¢ bookmarks    (id, device_id, news_id FK, UNIQUE(dev, news)) â”‚ â”‚
â”‚  â”‚ â€¢ user_prefs   (id, user_id FK, preferredCategories)          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Migrations: Flyway                                                 â”‚
â”‚  â”œâ”€ V1: Initial schema                                            â”‚ â”‚
â”‚  â””â”€ V2: Anonymous user conversion                                 â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“¡ API Endpoint Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ONBOARDING ENDPOINTS (NEW)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GET    /onboarding/languages                                    â”‚
â”‚ POST   /onboarding/step1        â† Language Selection            â”‚
â”‚ POST   /onboarding/step2        â† Age Selection                 â”‚
â”‚ POST   /onboarding/step3        â† Category Selection            â”‚
â”‚ GET    /onboarding/profile/{deviceId}                           â”‚
â”‚ GET    /onboarding/preferences/{deviceId}                       â”‚
â”‚ PUT    /onboarding/{deviceId}/language                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              NEWS & CATEGORY ENDPOINTS (PUBLIC)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GET    /news                    â† All News (Paginated)          â”‚
â”‚ GET    /news/{id}               â† Single News                   â”‚
â”‚ GET    /news/featured           â† Featured News                 â”‚
â”‚ GET    /news/category/{id}      â† News by Category              â”‚
â”‚ GET    /categories              â† All Categories                â”‚
â”‚ GET    /categories/{id}         â† Single Category               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         INTERACTION ENDPOINTS (UPDATED - USE deviceId)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ POST   /news/{id}/comments?deviceId={id}                        â”‚
â”‚ GET    /news/{id}/comments      â† Comments on Article           â”‚
â”‚ PUT    /news/{id}/comments/{id}                                 â”‚
â”‚ DELETE /news/{id}/comments/{id}                                 â”‚
â”‚                                                                 â”‚
â”‚ POST   /news/{id}/likes/toggle?deviceId={id}                    â”‚
â”‚ GET    /news/{id}/likes/status?deviceId={id}                    â”‚
â”‚                                                                 â”‚
â”‚ POST   /news/{id}/bookmarks/toggle?deviceId={id}                â”‚
â”‚ GET    /news/{id}/bookmarks/status?deviceId={id}                â”‚
â”‚ GET    /user/bookmarks?deviceId={id}  â† User's Bookmarks        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ”„ Onboarding State Machine

```
                    START
                      â”‚
                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Device ID     â”‚
            â”‚   Generated     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ LANGUAGE SELECTION       â”‚
      â”‚ (Step 1)                 â”‚
      â”‚                          â”‚
      â”‚ POST /onboarding/step1   â”‚
      â”‚ {deviceId, language}     â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ AGE SELECTION            â”‚
      â”‚ (Step 2)                 â”‚
      â”‚                          â”‚
      â”‚ POST /onboarding/step2   â”‚
      â”‚ {deviceId, age>=13}      â”‚
      â”‚                          â”‚
      â”‚ âœ“ Validation: age >= 13  â”‚
      â”‚ âœ— Reject: age < 13       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ CATEGORY SELECTION       â”‚
      â”‚ (Step 3)                 â”‚
      â”‚                          â”‚
      â”‚ POST /onboarding/step3   â”‚
      â”‚ {deviceId, categoryIds}  â”‚
      â”‚                          â”‚
      â”‚ âœ“ At least 1 category    â”‚
      â”‚ âœ— No categories selected â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ âœ… ONBOARDING COMPLETE   â”‚
      â”‚                          â”‚
      â”‚ User can now:            â”‚
      â”‚ â€¢ Browse news feed       â”‚
      â”‚ â€¢ View by category       â”‚
      â”‚ â€¢ Comment on articles    â”‚
      â”‚ â€¢ Like articles          â”‚
      â”‚ â€¢ Bookmark articles      â”‚
      â”‚ â€¢ Change language        â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“Š Data Flow Diagram

```
User Action                API Request              Processing              Database Operation
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

                        GET /onboarding/languages
                              â”‚
                              â–¼
                        OnboardingController
                              â”‚
                              â–¼
                        OnboardingService
                        .getAvailableLanguages()
                              â”‚
                              â–¼
                        Return 12 languages
                        (hardcoded in service)
                              â”‚
                              â–¼
                        HTTP 200 + JSON

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

POST /onboarding/step1
{deviceId, language}
                              â”‚
                              â–¼
                        OnboardingController
                        .completeStep1()
                              â”‚
                              â–¼
                        OnboardingService
                        .completeStep1()
                              â”‚
                              â”œâ”€ Validate language
                              â”‚
                              â–¼
                        UserRepository
                        .findByDeviceId()
                              â”‚
                              â–¼
                        CREATE or UPDATE User
                        (id, device_id, language, age, dates)
                              â”‚
                              â–¼
                        Save to Database
                        (INSERT or UPDATE)
                              â”‚
                              â–¼
                        HTTP 201 + UserProfileDTO

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

POST /news/1/comments?deviceId=abc123
{content: "Great!"}
                              â”‚
                              â–¼
                        CommentController
                        .createComment()
                              â”‚
                              â–¼
                        CommentService
                        .createComment()
                              â”‚
                              â”œâ”€ Validate news exists
                              â”œâ”€ Create Comment object
                              â”‚  (id, news_id, device_id, content, dates)
                              â”‚
                              â–¼
                        CommentRepository
                        .save()
                              â”‚
                              â–¼
                        INSERT INTO comments
                        (news_id, device_id, content, created_at, updated_at)
                              â”‚
                              â–¼
                        HTTP 201 + CommentDTO
```

---

## ðŸŽ¯ Component Interaction

```
OnboardingController
    â”‚
    â”œâ”€â”€ OnboardingService
    â”‚   â”‚
    â”‚   â”œâ”€â”€ UserRepository
    â”‚   â”‚   â””â”€â”€ Database: users table
    â”‚   â”‚
    â”‚   â””â”€â”€ UserPreferenceRepository
    â”‚       â””â”€â”€ Database: user_preferences table
    â”‚
    â””â”€â”€ Returns: DTOs (UserProfileDTO, etc.)

NewsController
    â”‚
    â”œâ”€â”€ NewsService
    â”‚   â”‚
    â”‚   â”œâ”€â”€ NewsRepository
    â”‚   â”œâ”€â”€ CategoryRepository
    â”‚   â”œâ”€â”€ LikeRepository (for counting)
    â”‚   â””â”€â”€ CommentRepository (for counting)
    â”‚       â””â”€â”€ Database: news, categories, likes, comments
    â”‚
    â””â”€â”€ Returns: NewsDTO with aggregated data

CommentController
    â”‚
    â”œâ”€â”€ CommentService
    â”‚   â”‚
    â”‚   â”œâ”€â”€ CommentRepository
    â”‚   â”œâ”€â”€ NewsRepository (for validation)
    â”‚   â””â”€â”€ UserRepository (removed)
    â”‚       â””â”€â”€ Database: comments
    â”‚
    â””â”€â”€ Returns: CommentDTO with device info

LikeController
    â”‚
    â”œâ”€â”€ LikeService
    â”‚   â”‚
    â”‚   â”œâ”€â”€ LikeRepository (deviceId queries)
    â”‚   â”œâ”€â”€ NewsRepository (for validation)
    â”‚   â””â”€â”€ UserRepository (removed)
    â”‚       â””â”€â”€ Database: likes
    â”‚
    â””â”€â”€ Returns: LikeResponse

BookmarkController
    â”‚
    â”œâ”€â”€ BookmarkService
    â”‚   â”‚
    â”‚   â”œâ”€â”€ BookmarkRepository (deviceId queries)
    â”‚   â”œâ”€â”€ NewsRepository (for validation)
    â”‚   â””â”€â”€ UserRepository (removed)
    â”‚       â””â”€â”€ Database: bookmarks
    â”‚
    â””â”€â”€ Returns: BookmarkResponse
```

---

## ðŸ“ˆ Request/Response Cycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CLIENT                                    â”‚
â”‚                                                                 â”‚
â”‚  localStorage: {deviceId: "device-abc123"}                     â”‚
â”‚                                                                 â”‚
â”‚  HTTP POST                                                      â”‚
â”‚  /onboarding/step3                                              â”‚
â”‚  Content-Type: application/json                                â”‚
â”‚  {                                                              â”‚
â”‚    "deviceId": "device-abc123",                                â”‚
â”‚    "preferredCategoryIds": [1, 2, 3]                           â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       SERVER                                     â”‚
â”‚                                                                  â”‚
â”‚  1. Receive Request at OnboardingController                     â”‚
â”‚  2. Call OnboardingService.completeStep3()                      â”‚
â”‚  3. Find User by deviceId                                       â”‚
â”‚  4. Create/Update UserPreference with categories               â”‚
â”‚  5. Save to Database                                            â”‚
â”‚  6. Build Response DTO                                          â”‚
â”‚  7. Return HTTP 200                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CLIENT                                     â”‚
â”‚                                                                  â”‚
â”‚  HTTP 200 OK                                                    â”‚
â”‚  Content-Type: application/json                                â”‚
â”‚  {                                                              â”‚
â”‚    "id": 1,                                                     â”‚
â”‚    "deviceId": "device-abc123",                                â”‚
â”‚    "age": 25,                                                   â”‚
â”‚    "preferredLanguage": "hi"                                    â”‚
â”‚  }                                                              â”‚
â”‚                                                                 â”‚
â”‚  âœ“ User ready to browse!                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**PocketNews v2.0 - Architecture Overview**  
**Generated: February 13, 2026**

